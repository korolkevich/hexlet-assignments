# CRUD in memory

CRUD — широко распространенный термин, означающий 4 стандартные операции над любой сущностью: создание, чтение, обновление и удаление. Часть CRUD, чтение и удаление, мы сделали в прошлом домашнем задании. В этом домашнем задании вам нужно будет реализовать оставшуюся часть CRUD — создание и обновление сущности. Создание и обновление сущности включают в себя по два действия: отображение формы и обработка данных формы.

## Ссылки

* [Формы Bootstrap](https://bootstrap-4.ru/docs/5.0/forms/overview/)
* [Html тег form](https://developer.mozilla.org/ru/docs/Web/HTML/Element/form)
* [Метод getParameter()](https://javaee.github.io/javaee-spec/javadocs/javax/servlet/ServletRequest.html#getParameter-java.lang.String-)
* [Тег input](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input)
* [Метод getOrDefault()](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Map.html#getOrDefault(java.lang.Object,V))

## servlet/UsersServlet.java

В этом упражнении мы продолжаем работать с данными, которые расположены в памяти. Список пользователей уже создан и записан в свойстве `users` класса `UsersServlet`. Структура списка такая же, как и в предыдущем упражнении.

## Задачи

* Изучите содержимое методов `doGet()` и `doPost()`, которые в зависимости от пути в адресе запроса вызывают нужный обработчик (метод).

* Метод `newUser()` выводит страницу с формой создания нового пользователя. Организуйте передачу управления в jsp-файл */new.jsp*.

* Метод `editUser()` выводит страницу с формой редактирования пользователя. Организуйте передачу управления в jsp-файл */edit.jsp*. Для удобства работы все поля формы должны быть заполнены данными пользователя. Для этого вам понадобится передать в jsp-файл данные пользователя.

* Метод `createUser()` обрабатывает данные формы создания нового пользователя. В методе реализуйте добавление нового пользователя в список пользователей. Чтобы получить из запроса данные, которые пользователь ввел в форму, воспользуйтесь методом `getParameter()` класса `HttpServletRequest`. В этом методе вам нужно будет выполнить валидацию — проверку корректности введенных данных пользователя. Имя и фамилия пользователя не должны быть пустыми. Если введенные данные не корректны, установите код ответа 422 (Unprocessable Entity) и отобразите страницу создания пользователя, передав управление в файл */new.jsp*. Чтобы на странице создания пользователя отобразить ошибку и заполнить поля формы, вам потребуется передать в форму сообщение об ошибке и введенные данные пользователя. Если данные корректны, добавьте пользователя в список и выполните редирект на страницу просмотра всех пользователей. Для генерации нового id используйте метод `getNextId()`.

* Метод `updateUser()` обрабатывает данные формы редактирования пользователя. В методе реализуйте обновление данных пользователя. Проверьте корректность введенных данных пользователя. Имя и фамилия пользователя не должны быть пустыми. Если введенные данные не корректны, установите код ответа 422 (Unprocessable Entity) и отобразите страницу редактирования пользователя, передав управление в файл */edit.jsp*. Чтобы на странице редактирования пользователя отобразить ошибку и заполнить поля формы данными, вам потребуется передать в форму сообщение об ошибке и введенные данные пользователя. Если данные корректны, скопируйте введенные данные из формы в сущность и сделайте редирект на станицу пользователя.

## webapp/new.jsp

Шаблон с формой создания нового пользователя.

## Задачи

* Организуйте вывод формы создания нового пользователя. Для создания текстовых полей используйте тег `<input>`. В форме должно быть три текстовых поля для ввода имени, фамилии и email пользователя. Если были введены некорректные данные, на странице должно выводиться сообщение об ошибке, а поля должны быть заполнены введенными данными. Чтобы добавить немного красоты в форму, используйте классы bootstrap.

```html
<form action="url" method="post">
    <div class="mb-3">
        <label>Имя</label>
        <input class="form-control" type="text" name="firstName" value="">
    </div>
    <button class="btn btn-primary" type="submit">Создать</button>
</form>
```

## webapp/edit.jsp

Шаблон с формой редактирования пользователя.

## Задачи

* Организуйте вывод формы редактирования данных пользователя. Поля формы для имени, фамилии и email пользователя должны быть заполнены данными пользователя. Если были введены некорректные данные, на странице должно выводиться сообщение об ошибке, а поля должны быть заполнены введенными данным.

## webapp/show.jsp

## Задачи

* Добавьте на страницу пользователя ссылку на страницу редактирования пользователя.

## Подсказки

* Для указания предварительно введенной строки для текстовых полей (input type="text") воспользуйтесь атрибутом `value`.
* Атрибут `name` тега `<input>` определяет имя элемента формы. Это имя используется при отправке данных на сервер. Чтобы получить эти данные в обработчике, воспользуйтесь методом `getParameter()`.
* Форма создания нового пользователя должна отображать введенные данные и сообщение об ошибке, если данные не прошли валидацию. Но при первом заполнении формы этих данных нет. Чтобы в шаблоне не возникла ошибка, в методе `newUser()` вам потребуется передать в шаблон "пустого пользователя" (пустой список `Map`) и пустое сообщение об ошибке, а в шаблоне воспользоваться методом `getOrDefault()` для получения данных пользователя.
